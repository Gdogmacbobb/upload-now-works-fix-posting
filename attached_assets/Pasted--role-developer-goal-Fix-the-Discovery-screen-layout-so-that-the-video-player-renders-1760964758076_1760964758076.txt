{
  "role": "developer",
  "goal": "Fix the Discovery screen layout so that the video player renders underneath the top navigation bar ('Following | Discovery') similar to TikTok or Instagram Reels, with automatic adjustment for iPhone notch sizes.",
  "context": {
    "issue": "The current video widget is in the layout flow, pushing the navigation bar downward. The video must be a full-screen background layer, with UI overlays (top nav, bottom nav, and side buttons) floating above it. Additionally, the layout should dynamically adapt to iPhone notch and safe area insets."
  },
  "instruction": {
    "layout_structure": {
      "type": "Stack",
      "description": "The Stack ensures the video is the background layer while overlays (navigation and buttons) stay above it. SafeArea and dynamic padding detect device insets to handle notches correctly.",
      "code": "import 'package:flutter/material.dart';\nimport 'package:flutter/services.dart';\n\nclass DiscoveryScreen extends StatelessWidget {\n  const DiscoveryScreen({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    final mediaQuery = MediaQuery.of(context);\n    final topInset = mediaQuery.padding.top; // Detect notch/safe area\n    final bottomInset = mediaQuery.padding.bottom;\n\n    return AnnotatedRegion<SystemUiOverlayStyle>(\n      value: SystemUiOverlayStyle.light,\n      child: Scaffold(\n        backgroundColor: Colors.black,\n        body: Stack(\n          children: [\n            // ðŸ‘‡ Full-screen video background\n            Positioned.fill(\n              child: YourVideoFeedWidget(),\n            ),\n\n            // ðŸ‘‡ Top navigation overlay ('Following | Discovery')\n            Positioned(\n              top: topInset, // Dynamically adjusts for iPhone notches\n              left: 0,\n              right: 0,\n              child: Container(\n                padding: const EdgeInsets.symmetric(vertical: 10),\n                decoration: BoxDecoration(\n                  gradient: LinearGradient(\n                    colors: [Colors.black.withOpacity(0.4), Colors.transparent],\n                    begin: Alignment.topCenter,\n                    end: Alignment.bottomCenter,\n                  ),\n                ),\n                child: Row(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: const [\n                    Text(\n                      'Following',\n                      style: TextStyle(\n                        color: Colors.grey,\n                        fontSize: 16,\n                        fontWeight: FontWeight.w500,\n                      ),\n                    ),\n                    SizedBox(width: 20),\n                    Text(\n                      'Discovery',\n                      style: TextStyle(\n                        color: Colors.orange,\n                        fontSize: 16,\n                        fontWeight: FontWeight.bold,\n                      ),\n                    ),\n                  ],\n                ),\n              ),\n            ),\n\n            // ðŸ‘‡ Right-side vertically centered buttons\n            Positioned(\n              right: 10,\n              top: 0,\n              bottom: 0,\n              child: Center(\n                child: Column(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: [\n                    Icon(Icons.person_outline, color: Colors.orange, size: 28),\n                    SizedBox(height: 20),\n                    Icon(Icons.favorite_border, color: Colors.white, size: 28),\n                    SizedBox(height: 20),\n                    Icon(Icons.comment_outlined, color: Colors.white, size: 28),\n                    SizedBox(height: 20),\n                    Icon(Icons.share_outlined, color: Colors.white, size: 28),\n                    SizedBox(height: 20),\n                    Container(\n                      decoration: BoxDecoration(\n                        color: Colors.orange,\n                        shape: BoxShape.circle,\n                      ),\n                      padding: const EdgeInsets.all(10),\n                      child: Icon(Icons.attach_money, color: Colors.white),\n                    ),\n                  ],\n                ),\n              ),\n            ),\n\n            // ðŸ‘‡ Bottom navigation overlay (with safe padding)\n            Positioned(\n              left: 0,\n              right: 0,\n              bottom: bottomInset,\n              child: Container(\n                color: Colors.black,\n                padding: EdgeInsets.only(bottom: bottomInset > 0 ? bottomInset : 8),\n                child: BottomNavigationBar(\n                  backgroundColor: Colors.black,\n                  selectedItemColor: Colors.orange,\n                  unselectedItemColor: Colors.grey,\n                  items: const [\n                    BottomNavigationBarItem(icon: Icon(Icons.search), label: ''),\n                    BottomNavigationBarItem(icon: Icon(Icons.camera_alt), label: ''),\n                    BottomNavigationBarItem(icon: Icon(Icons.home), label: ''),\n                  ],\n                ),\n              ),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n}"
    }
  },
  "expected_result": [
    "âœ… The video now fills the full screen and appears underneath all UI overlays.",
    "âœ… The 'Following | Discovery' bar overlays on top, properly aligned regardless of iPhone model or notch size.",
    "âœ… The right-side action buttons are vertically centered and not clipped.",
    "âœ… The bottom navigation bar floats above the video with safe area padding.",
    "âœ… The layout mirrors TikTokâ€™s immersive full-screen video experience."
  ],
  "commentary": "This version detects and applies dynamic SafeArea padding to handle all iPhone and Android notch configurations. Using Positioned.fill ensures the video remains the visual background layer, while the UI overlays adapt to the deviceâ€™s insets for perfect alignment on all screens."
}